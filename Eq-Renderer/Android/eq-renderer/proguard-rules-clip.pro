# -------------------------------------------------------------------
# 允许修改访问权限，使混淆更彻底
# -------------------------------------------------------------------
-allowaccessmodification

# -------------------------------------------------------------------
# 重新打包类，减少包名长度
# -------------------------------------------------------------------
-repackageclasses ''

# -------------------------------------------------------------------
# 混淆 Filament，除了 JNI 调用和反射访问的类
# -------------------------------------------------------------------
# 1. 保留 JNI native 方法
-keepclasseswithmembernames class com.google.android.filament.** {
    native <methods>;
}

# 2. 保留通过反射访问的注解类
-keep class com.google.android.filament.proguard.UsedBy* { *; }
-keep @com.google.android.filament.proguard.UsedBy* class * { <init>(); }
-keepclassmembers class * {
    @com.google.android.filament.proguard.UsedBy* *;
}

# -------------------------------------------------------------------
# 保留必要属性，避免泛型、内部类混淆导致错误
# -------------------------------------------------------------------
-keepattributes InnerClasses,Signature,SourceFile,LineNumberTable

# -------------------------------------------------------------------
# 对 Filament 其它所有类允许混淆、重命名、剔除未使用
# -------------------------------------------------------------------
# 只保留 public API 可选，非 JNI/反射的其余都可以混淆
# 注意 ! 前缀表示排除这些特例
-keep public class !com.google.android.filament.proguard.**, !com.google.android.filament.** { *; }

# -------------------------------------------------------------------
# 默认开启混淆和剔除未使用类
# -------------------------------------------------------------------
# 如果开启 -dontshrink，则不会剔除未使用类
# 如果希望自动剔除未使用类，请不要加 -dontshrink
# -dontshrink
